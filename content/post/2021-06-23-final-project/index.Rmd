---
title: Assignment05
author: Xiao Ji
date: '2021-06-18
slug: Assignment05
categories:
  - ggplot2
  - tidyverse
  - tidymodels
tags: []
---
```{r}
library(GGally)
library(tidymodels)
set.seed(2020)
```

## Load Data
```{r}
data("diamonds")
glimpse(diamonds)
```

## Create Correlation Matrix
```{r}
diamonds %>%
    mutate_if(is.factor,as.numeric) %>%
    select(price,everything()) %>%
    ggcorr(method = c("everything", "pearson"),label = T)
```


```{r echo=FALSE, warning=FALSE}
dia_split<-initial_split(diamonds,prop=.5)
dia_train<-training(dia_split)
dia_test<-testing(dia_split) 
dim(dia_split)
dia_vfold<-vfold_cv(dia_train,v=3,repeats=1)
dia_vfold %>%
   mutate(df_ana=map(splits,analysis),
          df_ass=map(splits,assessment))
```


```{r}
dia_train%>%
ggplot(aes(x=carat,y=price))+
  scale_y_continuous(trans=log_trans(),labels=function(x) round(x,-2))+
  geom_point()+
  geom_smooth(method="lm",formula="y~poly(x,4)")+
  theme_bw()
```






